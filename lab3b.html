<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choropleth Map of US Drought Data</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 600px; }
    </style>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- D3.js for color scale -->
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
</head>
<body>

    <h1>US Drought Map (Choropleth)</h1>
    <div id="map"></div>

    <script>
        // Initialize the map
        var map = L.map('map').setView([37.8, -96], 4); // Centered on the US

        // Add OpenStreetMap tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Load GeoJSON data (usdm_current.json) containing polygons
        fetch('usdm_current.json')
            .then(response => response.json())
            .then(data => {
                // Function to style the polygons based on some property
                function style(feature) {
                    // Assuming the dataset has a property like "severity" (adjust if needed)
                    var severity = feature.properties.severity; // Replace with correct property
                    var color = severity ? getColor(severity) : '#ffffff';
                    
                    return {
                        fillColor: color,
                        weight: 2,
                        opacity: 1,
                        color: 'white',
                        fillOpacity: 0.7
                    };
                }

                // Create a color scale using d3.js (use any color scale you prefer)
                function getColor(d) {
                    return d3.scaleSequential(d3.interpolateYlOrRd)
                        .domain([0, 5])(d); // Adjust domain to match your severity scale
                }

                // Add the GeoJSON to the map with custom styles
                L.geoJSON(data, {
                    style: style,
                    onEachFeature: function (feature, layer) {
                        var popupContent = `
                            <strong>Area: ${feature.properties.name || 'N/A'}</strong><br>
                            Severity: ${feature.properties.severity || 'Unknown'}
                        `;
                        layer.bindPopup(popupContent);
                    }
                }).addTo(map);
            })
            .catch(error => console.error('Error loading GeoJSON data:', error));
    </script>

</body>
</html>
